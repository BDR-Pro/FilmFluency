{% extends 'base.html' %}

{% block title %}
    Products
{% endblock %}

{% block content %} 
<div class="container mt-5">
    <div class="row row-cols-1 row-cols-md-3 g-4 justify-content-center">
        {% for product in products %}
        <a href="{% url 'payment:subscribe' %}?product={{product.id}}" class="col btn custom-btn">
            <div class="col">
                <div class="card h-100 {% if product.featured %}featured{% endif %}" onclick="toggleDetails(this)">
                    <img src="{{ product.image }}" class="card-img-top" alt="{{ product.name }}">
                    <div class="card-body">
                        <h5 class="card-title text-truncate">{{ product.name }}</h5>
                        <p class="card-text">{{ product.price }}</p>
                        {% if product.featured %}
                            <span class="badge bg-warning text-dark">Best Price</span>
                        {% endif %}
                        <div class="details">
                            <p class="card-text">{{ product.description }}</p>
                            <p class="card-text">Duration: {{ product.days }} day(s)</p>
                        </div>
                    </div>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
</div>

<a href="{% url 'payment:how-its-works' %}" 

<div class="d-grid gap-2">
    <button class="btn btn-outline-info" type="button">How it Works</button>

</div>
</a>

{% endblock %}


{% block extra_css %}
<style>
    .card {
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        margin-bottom: 2rem; /* Extra space at the bottom */
    }
    .card:hover, .card:focus {
        transform: scale(1.03); /* Slight scale on hover and focus for all cards */
        box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Shadow for depth */
    }
    .featured {
        transform: scale(1.1) !important; /* Larger scale for featured card */
        z-index: 1;
        position: relative; /* To ensure z-index is applied correctly */
        box-shadow: 0 6px 12px rgba(0,0,0,0.1); /* Stronger shadow for featured card */
    }
    .featured:hover, .featured:focus {
        box-shadow: 0 8px 16px rgba(0,0,0,0.2); /* Even stronger shadow on hover/focus for featured */
    }
    .featured .card-body::before {
        content: 'Best Price';
        color: #fff;
        background-color: #dc3545;
        font-size: 14px;
        font-weight: bold;
        padding: 5px 10px;
        position: absolute;
        top: 10px;
        right: 10px;
        border-radius: 5px;
    }
    .details {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.5s ease-out;
    }
    .card:hover .details,
    .card:focus .details,
    .card:active .details {  /* Ensure it works on click for all cards */
        max-height: 500px; /* Large enough max-height to show all content */
    }
    .custom-btn {
        text-decoration: none;
        color: inherit;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    function toggleDetails(cardElement) {
        const details = cardElement.querySelector('.details');
        // Allow all cards to toggle details, including featured
        if (details.style.maxHeight) {
            details.style.maxHeight = null;
        } else {
            details.style.maxHeight = details.scrollHeight + "px";
        }
    }
</script>
{% endblock %}
